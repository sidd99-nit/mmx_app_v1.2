<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Analytics Platform</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@700&display=swap" rel="stylesheet">

    <!-- for font all  -->
    <style>
        * {
            font-size: 'Arial' , sans-serif !important;
        }
    </style>

    <style>
        body{
            background-color: #050914;
        }
    </style>

    <!-- for the first navbar -->
    <style>
        /* Import the Poppins and Montserrat fonts */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap');
        
        /* Navbar styles */
        .navbar-custom {
          background-color: #111827; /* Deep futuristic background */
          color: rgb(255, 255, 255);
          padding: 2vh;
          border-bottom: 0.01px solid #475363; /* Soft border */
          border-top: 0.01px solid #475363; /* Soft border */
          border-left: 0.01px solid #475363; /* Soft border */
          border-right: 0.01px solid #475363; /* Soft border */

          margin-bottom: 0.5%;
          margin-right: 0.1%;
          margin-left: -0.01%;
          margin-top: 0.15%;
        }
    
        .navbar-brand, .navbar-nav .nav-link {
          color: white;
          font-weight: 600;
          letter-spacing: 0.05vh; /* Sleek spacing */
          transition: color 0.3s ease, transform 0.3s ease; /* Smooth transitions */
        }
    
        .navbar-brand:hover, .navbar-nav .nav-link:hover {
          color: #00d1ff; /* Neon blue hover effect */
          transform: scale(1.05); /* Slight scaling on hover */
          background-color: #374151;
          border-radius: 1vh;
        }
    
        /* Gradient text for navbar brand */
        .navbar-brand {
          font-family:  Geneva, Tahoma, sans-serif;
          font-size: larger;
          background: linear-gradient(45deg, #106af3 , #0193c7,#019a90);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          text-decoration: none;
        }
    
        /* Navigation links */
        .nav-link {
          font-size: small;
          letter-spacing: 0.06vh;
          color: rgb(236, 236, 236);
        }
    
        /* User info section */
        .user-info {
          display: flex;
          align-items: center;
          color: white;
          font-weight: 500;
          letter-spacing: 0.07vh;
          font-size: small;
        }
    
        .user-info span {
          margin-left: 10px;
          font-weight: 500;
        }
    
        /* User initials */
        .user-initials {
          width: 5vh;
          height: 5vh;
          display: flex;
          align-items: center;
          justify-content: center;
          background: linear-gradient(18deg, #106af3 , #0193c7,#019a90);
          color: white;
          font-weight: 200;
          border-radius: 50%;
          box-shadow: 0 2px 10px rgba(114, 114, 114, 0.6); /* Glow effect */
          transition: box-shadow 0.3s ease;
          font-family: 'Poppins', sans-serif; /* Aesthetic font */
        }
    
        .user-initials:hover {
          box-shadow: 0 2px 15px rgba(23, 162, 184, 1); /* Intense glow on hover */
        }
    
        .container-fluid {
          height: 16.5%;
          margin-bottom: 3.5%;
        }
      </style>
  
    <!-- for second navbar -->
    <style>
        #breadcrumb-navbar-container {
            display: flex; /* Enable flexbox */
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
            width: 100%; /* Full width */
            padding: 20px 0; /* Spacing above and below */
            margin-top: -1.5%;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            background-color: transparent;
            padding: 10px 20px; /* Adjust padding for content fitting */
            border-radius: 2vh; /* Rounded corners */
            box-shadow: 0 4px 15px rgba(255, 255, 255, 0.01); /* Subtle shadow */
            transition: box-shadow 0.3s; /* Shadow transition */
            margin-top: 1.8%;
        }

        .breadcrumb:hover {
            box-shadow: 0 8px 30px rgba(255, 255, 255, 0.05); /* Slightly darker shadow on hover */
        }

        .breadcrumb a {
            text-decoration: none;
            background-color: #1F2937;
            color: #CED0D4; /* Dark gray for links */
            padding: 1.1vh 1.3vh; /* Adjusted for better fit */
            transition: color 0.3s, transform 0.3s; /* Smooth transitions */
            border-radius: 2vh; /* Rounded corners for links */
            position: relative; /* Position for pseudo-element */
            padding: 1.5vh;
        }

        .breadcrumb a:hover {
            color: #ededed; /* White text on hover */
            background-color: #39485e; /* Soft blue background on hover */
            transform: scale(1.05); /* Slightly enlarge link on hover */
        }

        /* Active link styling */
        .breadcrumb a.active {
            color: #131314; /* White text for active link */
            font-weight: 600;
            background-color: #155fae; /* Soft blue background for active link */
            /* background: linear-gradient(135deg, #003cff , #7700ff , #ff0099); */
            /* background: linear-gradient(135deg, #ff1fa6 , #ff4cc9 , #ffa1d9); */
            /* background: linear-gradient(45deg, #144bff , #4262ff,#ff0099); */
            background: linear-gradient(45deg, #106af3 , #0193c7,#019a90);
            transform: scale(1.05); /* Slightly enlarge active link */
        }

        .breadcrumb a::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: #39485e; /* Soft blue underline */
            bottom: -5px; /* Position below the link */
            left: 0;
            transform: scaleX(0);
            transition: transform 0.3s; /* Smooth transition for underline */
        }

        .breadcrumb a:hover::after {
            transform: scaleX(1); /* Expand underline on hover */
        }

        .breadcrumb .separator {
            margin: 0 10px;
            color: #6d6d6d; /* Light gray color for separator */
            font-weight: bold; /* Bold separator */
        }

        @media (max-width: 768px) {
            .breadcrumb {
                flex-direction: column; /* Stack links on smaller screens */
            }
            .breadcrumb a {
                padding: 8px 0; /* Reduce padding for mobile */
            }
        }
    </style>

    <!-- for uploading files sales and media -->
    <style>

        /* General Aesthetic Font */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap');

        /* Styling for the file upload container */
        .upload-container {
        padding: 20px;
        margin-top: -1.6%;
        }

        .custom-card {
        background-color: #1F2937; /* Off-white background for the cards */
        border-bottom: 0.01px solid #475363; /* Soft bottom border */
        border-top: 0.01px solid #475363;
        border-left: 0.01px solid #475363;
        border-right: 0.01px solid #475363;
        border-radius: 1vh; /* Rounded corners */
        box-shadow: 0 10px 35px rgba(0, 0, 0, 0.2); /* Softer shadow for more subtle depth */
        transition: box-shadow 0.3s ease, transform 0.3s ease;
        height: fit-content;
        }

        .custom-card:hover {
        box-shadow: 0 10px 45px rgba(0, 0, 0, 0.15); /* Stronger shadow for a dynamic hover effect */
        transform: translateY(-5px); /* Lift effect on hover */
        }

        .custom-card-header {
        background-color: #1F2937; /* Light off-white for the card header */
        border-bottom: 0.01px solid #475363; /* Soft bottom border */
        border-top: 0.01px solid #475363;
        border-left: 0.01px solid #475363;
        border-right: 0.01px solid #475363;
        /* background: linear-gradient(135deg, #d0dbff , #ebddff , #ffdfff);  */
        /*override with gradient background */
        /* background: linear-gradient(135deg, #faffea , #efe1ff , #e0e8ff);  */

        color: #353535; /* Darker grey text for contrast */
        font-weight: 500;
        border-top-left-radius: 1vh;
        border-top-right-radius: 1vh;
        height: 8vh;
        padding: 1.4%;
        text-align: center;
        letter-spacing: 0.1vh; /* Modern letter-spacing */
        }

        /* Upload area with off-white tones, dashed lines */
        .upload-area {
        background: #374151; /* Slightly off-white background for a clean look */
        border: 0.25vh dashed #818181; /* Subtle light grey dashed border */
        border-radius: 2vh; /* Slightly rounded corners */
        padding: 3vh;
        text-align: center;
        transition: background 0.4s ease, transform 0.3s ease;
        color: #444; /* Dark grey for base text */
        box-shadow: 3px 3px 15px rgba(0, 0, 0, 0.03), -3px -3px 10px rgba(255, 255, 255, 0.01); /* Soft, subtle shadows for depth */
        position: relative;
        }

        .upload-area:hover {
        background: #4b5666; /* Slightly darker off-white background on hover */
        transform: translateY(-3px); /* Light hover effect */
        cursor: pointer;
        }

        .upload-area p {
        margin: 0;
        font-weight: 400;
        color: #666; /* Mid-grey for text */
        letter-spacing: 0.5px; /* Add some modern spacing to text */
        }

        /* Button styles */
        .btn-danger {
        background-color: #ff4b4b; /* Soft red for the remove button */
        border: none;
        border-radius: 0.5vh; /* Slightly rounded corners for buttons */
        transition: background-color 0.3s ease;
        height: 4vh;
        width: 9vh;
        font-size: xx-small;
        padding-top: -1%;
        }

        .btn-danger:hover {
        background-color: #ff0000; /* Slightly darker red on hover */
        }

        /* File info styling */
        .file-info {
        font-size: 15px;
        color: #CED0D4; /* Darker grey for file info */
        }

        .filename {
        font-weight: 600;
        margin-left: 36vh;
        }

    </style>

    <!-- for below first nav -->
    <style>

        #below-first-nav{
            /* background: linear-gradient(135deg, #d1e7ff , #f3eaff , #fff4ff); */ 
            /* background: linear-gradient(to right, #60a5fa, #f472b6); */ 
            /* background: linear-gradient(to right, #60a5fa, #f472b6); */
            border-radius: 0vh;
            /* background: linear-gradient(135deg, #e0e8ff , #efe1ff , #ffdff2);  */
            background-color: #050914;
            padding-bottom: 1%;     
        }

    </style>

    <!-- styling for modal and it's trigger buttons -->
    <style>
        /* Style for the custom button */
        .custom-button {
            background: #374151; /* Slightly off-white background for a clean look */
            border: 0.25vh dashed #818181; /* Subtle light grey dashed border */
            border-radius: 2vh; /* Slightly rounded corners */
            background-color: transparent;
            font-size: 2.5vh; 
            color: #CED0D4;
            font-style: italic;
            padding: 10px 20px;
            display: inline-block;
            cursor: pointer;
            font-size: 2.3vh;
            text-align: center;
            margin-left: 36vh;
            margin-top: -30vh;
            height: fit-content;
            width: fit-content;
        }

        /* Modal Background */
        .modal-backdrop {
        background-color: rgba(0, 0, 0, 0.5); /* Slightly dark background */
        border-bottom-left-radius: 12px; /* Smooth footer corners */
        border-bottom-right-radius: 12px;
        }

        /* Modal Content */
        .modal-content {
        border-radius: 12px;  /* Smooth rounded corners */
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);  /* Subtle shadow for depth */
        border: none; /* Remove default borders */
        background-color: #fefefe; /* Light background */
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Modern font */
        height: 90%;
        margin-top: 4.8vh;
        width: 90%;
        margin-left: 12vh;
        border-bottom-left-radius: 12px; /* Smooth footer corners */
        border-bottom-right-radius: 12px;
        }

        /* Modal Header */
        .modal-header {
        border-bottom: 1px solid #ddd;  /* Soft border for separation */
        padding: 16px;
        background-color: #004085; /* Professional blue background */
        color: white;  /* White text for contrast */
        border-top-left-radius: 12px;  /* Smooth header corners */
        border-top-right-radius: 12px;
        }

        /* Modal Title */
        .modal-title {
        font-size: 1.5rem;  /* Slightly larger title */
        font-weight: 500;  /* Medium weight for professional feel */
        }

        /* Modal Body */
        .modal-body {
        padding: 20px; /* Increased padding for better spacing */
        color: #333; /* Darker text for better readability */
        line-height: 1.6; /* Line height for better readability */
        border-bottom-left-radius: 12px; /* Smooth footer corners */
        border-bottom-right-radius: 12px;
        }

        /* Modal Footer */
        .modal-footer {
        border-top: 1px solid #ddd;  /* Soft border for separation */
        padding: 16px;
        background-color: #f8f9fa;  /* Light gray background */
        border-bottom-left-radius: 12px; /* Smooth footer corners */
        border-bottom-right-radius: 12px;
        }

        /* Close Button */
        .close {
        color: #757575; /* White close button in header */
        opacity: 1;
        text-shadow: none; /* Remove default text shadow */
        }

        .close:hover {
        color: #000000; /* Lighten close button on hover */
        cursor: pointer;
        }

        /* Modal Buttons */
        .modal-footer .btn {
        padding: 8px 16px;  /* Slightly larger buttons */
        font-size: 1rem;  /* Increase button text size */

        }

        .modal-footer .btn-primary {
        background-color: #007bff;  /* Professional blue button */
        border-color: #007bff;
        }

        .modal-footer .btn-primary:hover {
        background-color: #0056b3;  /* Darker blue on hover */
        }

        .modal-footer .btn-secondary {
        background-color: #6c757d;  /* Neutral gray button */
        border-color: #6c757d;
        }

        .modal-footer .btn-secondary:hover {
        background-color: #5a6268;  /* Darker gray on hover */
        }
    </style>

</head>
<body>
   
    <div class="container-fluid p-0">
        <nav id="main-navbar" class="navbar navbar-expand-lg navbar-dark navbar-custom">
            <a class="navbar-brand" href="/main" style= "letter-spacing: 0.001vh; font-size: 3.4vh; background: linear-gradient(45deg, #106af3 , #0193c7,#019a90); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-decoration: none;">Marketing Analytics Platform</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/main" style="margin-left: 92vh; font-size: small; letter-spacing: 0.06vh; color: #b7b9bc;">New Project</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/main" style="margin-left:4vh; font-size: small;  letter-spacing: 0.06vh; color: #b7b9bc;">Open Project</a>
                    </li>
                </ul>

                <div class="separator" style="margin-right: 2vh; height: 4vh; width: 0.1vh; background-color: #57657d;"></div>

                <div class="user-info">
                    <span id="current-date" style="color: #57657d;"></span>
                    <div class="user-initials ml-3">
                        SK
                    </div>
                </div>
            </div>
        </nav>
    
    </div>


    <!-- div for the entire thing  -->

    <div id="below-first-nav" style="margin-top: -6.3%;">

        <!-- Breadcrumb Style Tabs Navbar -->
        <div id="breadcrumb-navbar-container">
            <nav class="breadcrumb">
                <a href="/main" class="active">Data Input and Exploration</a>
                <span class="separator">&gt;</span>
                <a href="/main">Model Data Preparation</a>
                <span class="separator">&gt;</span>
                <a href="/main">Model Execution</a>
                <span class="separator">&gt;</span>
                <a href="/main">Model Results</a>
            </nav>
        </div>

    
        <div class="container-fluid" style="margin-top: 2.8%;">
            <div class="upload-container">
                <!-- File Upload Section -->
                <div class="row mb-3">
                    <div class="col-12" style="display: flex; justify-content: space-between;">
                        <!-- First Card: Sales File -->
                        <div class="custom-card" style="width: 49%; margin-right: 3%; margin-left: -1.6%;">
                            <div class="custom-card-header">
                                <span style="font-size: 3vh; color: #CED0D4;">Sales File</span>
                            </div>
                            <div class="card-body" style="display: flex; justify-content: space-between;">
                                <div style="width: 100%;">
                                    <div id="upload-area-1" class="upload-area">
                                        <p style="font-size: 2.5vh; color: #CED0D4; font-style: italic;">Click or Drag and Drop a CSV file here to upload</p>
                                    </div>
                                    <input type="file" id="file-input-1" style="display: none;">
                                    <div id="file-info-1" class="file-info" style="display: none;">
                                        <span id="filename-1" class="filename"></span>
                                        <button id="remove-file-1" class="btn btn-danger btn-sm ml-2">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
        
                        <!-- Second Card: Media File -->
                        <div class="custom-card" style="width: 50%; margin-right: -1.6%;">
                            <div class="custom-card-header">
                                <span style="font-size: 3vh; color: #CED0D4;">Media File</span>
                            </div>
                            <div class="card-body" style="display: flex; justify-content: space-between;">
                                <div style="width: 100%;">
                                    <div id="upload-area-2" class="upload-area">
                                        <p style="font-size: 2.5vh; color: #CED0D4; font-style: italic;">Click or Drag and Drop a CSV file here to upload</p>
                                    </div>
                                    <input type="file" id="file-input-2" style="display: none;">
                                    <div id="file-info-2" class="file-info" style="display: none;">
                                        <span id="filename-2" class="filename"></span>
                                        <button id="remove-file-2" class="btn btn-danger btn-sm ml-2">Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
        
                    <!-- Custom Buttons Below the Cards -->
                    <div class="col-12" id="triggerModal" style="display: none; justify-content: space-between; margin-top: 35vh; margin-left: -20vh;">
                        <!-- First Custom Button -->
                        <div class="custom-button" id="openModal1" style="width: 49%;">Open Sales File Report</div> 
                
                        <!-- Second Custom Button -->
                        <div class="custom-button" id="openModal2" style="width: 50%;">Open Media File Report</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal for Sales File -->
        <div id="myModal1" class="modal">
            <div class="modal-content">
                <span class="close" id="closeModal1">&times;</span>
                <object id="html-content-sales" data="" type="text/html" style="width: 100%; height: 95% ; border-bottom-left-radius: 12px; border-bottom-right-radius: 12px;"></object>
            </div>
        </div> 

        <!-- Modal for Media File -->
        <div id="myModal2" class="modal">
            <div class="modal-content">
                <span class="close" id="closeModal2">&times;</span>
                <object id="html-content-media" data="" type="text/html" style="width: 100%; height: 95%; border-bottom-left-radius: 12px; border-bottom-right-radius: 12px;"></object>
            </div>
        </div>


        <!-- <div id="content-div"  style="margin-top: -4%; margin-left: 1.85%; width: 96%; height: 100vh;">

            <object id="html-content" data="" type="text/html" style="width: 100%; height: 90%;"></object>

        </div> -->

        <!-- Save and Continue Button -->
        <button id="save-continue" class="btn btn-primary btn-block" style="margin-top: -5.5%;  width: fit-content; margin-left: 85.5%; background: linear-gradient(45deg, #106af3 , #0193c7,#019a90); color: #131314; border: #0e3046; font-weight: 500; display: none;" >Save and Continue</button>

    </div>
    
    <!-- div that has the entire body -->

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
    <!-- handling files -->
    <script>
        let files_1 = null;
        let files_2 = null;

        // File upload functionality for the first file
        $('#upload-area-1').on('click', function() {
            $('#file-input-1').click();
        });

        $('#upload-area-1').on('dragover', function(e) {
            e.preventDefault();
            $(this).addClass('hover');
        });

        $('#upload-area-1').on('dragleave', function() {
            $(this).removeClass('hover');
        });

        $('#upload-area-1').on('drop', function(e) {
            e.preventDefault();
            $(this).removeClass('hover');
            files_1 = e.originalEvent.dataTransfer.files;
            const file_1 = files_1[0];
            $('#filename-1').text(file_1.name);
            $('#upload-area-1').hide();
            $('#file-info-1').show();
            handleFiles();  // Calls the function to handle both files when uploaded
        });

        $('#file-input-1').on('change', function(e) {
            files_1 = e.target.files;
            const file_1 = files_1[0];
            $('#filename-1').text(file_1.name);
            $('#upload-area-1').hide();
            $('#file-info-1').show();
            handleFiles();  // Calls the function to handle both files when uploaded
        });

        $('#remove-file-1').on('click', function() {
            resetFileInput(1);  // Resets the file input for file 1
        });

        // File upload functionality for the second file
        $('#upload-area-2').on('click', function() {
            $('#file-input-2').click();
        });

        $('#upload-area-2').on('dragover', function(e) {
            e.preventDefault();
            $(this).addClass('hover');
        });

        $('#upload-area-2').on('dragleave', function() {
            $(this).removeClass('hover');
        });

        $('#upload-area-2').on('drop', function(e) {
            e.preventDefault();
            $(this).removeClass('hover');
            files_2 = e.originalEvent.dataTransfer.files;
            const file_2 = files_2[0];
            $('#filename-2').text(file_2.name);
            $('#upload-area-2').hide();
            $('#file-info-2').show();
            handleFiles();  // Calls the function to handle both files when uploaded
        });

        $('#file-input-2').on('change', function(e) {
            files_2 = e.target.files;
            const file_2 = files_2[0];
            $('#filename-2').text(file_2.name);
            $('#upload-area-2').hide();
            $('#file-info-2').show();
            handleFiles();  // Calls the function to handle both files when uploaded
        });

        $('#remove-file-2').on('click', function() {
            resetFileInput(2);  // Resets the file input for file 2
        });

        // Function to handle both files after they are selected or dropped
        async function handleFiles() {
            if (files_1 && files_2) {  // Ensures both files are available
                const file_1 = files_1[0];
                const file_2 = files_2[0];

                const formData = new FormData();
                formData.append('file_1', file_1);  // Append the first file to the form data
                formData.append('file_2', file_2);  // Append the second file to the form data

                // Fetch API to send the files to the server for processing
                try {
                    const response = await fetch('/upload', {
                        method: 'POST',
                        body: formData,
                    });

                    if (response.ok) {
                        const result = await response.json();

                        // Dynamically load the HTML content into the div for sales and media
                        document.getElementById('html-content-sales').data = result.file_path_sales;
                        document.getElementById('html-content-media').data = result.file_path_media;

                        // make the save and continue button visible
                        document.getElementById('save-continue').style.display = 'block'

                        // make the modal trigger buttons visible
                        document.getElementById('triggerModal').style.display = 'flex'

                    } else {
                        const errorResponse = await response.json();
                        alert(`Error uploading file: ${errorResponse.error}`);
                    }
                } catch (error) {
                    alert(`Error uploading file: ${error.message}`);
                }
            }
        }

        // Function to reset file input areas (for both files)
        function resetFileInput(fileNumber) {
            if (fileNumber === 1) {
                files_1 = null;
                $('#filename-1').text('');
                $('#file-info-1').hide();
                $('#upload-area-1').show();
                $('#file-input-1').val(null);  // Clear the input field
            } else if (fileNumber === 2) {
                files_2 = null;
                $('#filename-2').text('');
                $('#file-info-2').hide();
                $('#upload-area-2').show();
                $('#file-input-2').val(null);  // Clear the input field
            }
        }
    </script>

    <script>
        document.addEventListener("DOMContentLoaded",function(){
            const currentDate = new Date();
            const formattedDate = currentDate.toLocaleDateString('en-GB');
            document.getElementById('current-date').innerText = `Date: ${formattedDate}`;
        });
    </script>

    <script>
        document.getElementById('save-continue').addEventListener('click', function() {

            // Get the uploaded files
            const formData = new FormData();
            
            if (files_1 && files_1[0]) {
                formData.append('file_1', files_1[0]);
            }
            if (files_2 && files_2[0]) {
                formData.append('file_2', files_2[0]);
            }

            // Send data and files to Flask server
            $.ajax({
                url: '/pre-qc',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function(response) {
                    // alert('Data saved successfully!');
                    // Redirect or perform any other action after success
                    // Redirect to the URL provided in the response
                     window.location.href = response.redirect_url;
                },
                error: function(xhr) {
                    const errorResponse = JSON.parse(xhr.responseText);
                    alert(`Error saving data: ${errorResponse.error}`);
                }
            });
        });
    </script>

    <!-- for opening sales modal -->
    <script>
        // Get modal elements
        var modal1 = document.getElementById("myModal1");
        var modal2 = document.getElementById("myModal2");

        // Get the buttons that open the modals
        var btn1 = document.getElementById("openModal1");
        var btn2 = document.getElementById("openModal2");

        // Get the <span> elements that close the modals
        var span1 = document.getElementById("closeModal1");
        var span2 = document.getElementById("closeModal2");

        // When the user clicks the first button, open the first modal
        btn1.onclick = function() {
            modal1.style.display = "block";

            // to vanish the blue colored objects
            var navbarBrand = document.getElementsByClassName("navbar-brand");
            for (var i = 0; i < navbarBrand.length; i++) {
                navbarBrand[i].style.display = 'none';
            }

            var userInitials = document.getElementsByClassName("user-initials ml-3");
            for (var i = 0; i < userInitials.length; i++) {
                userInitials[i].style.display = 'none';
            }

            document.getElementById("save-continue").style.display = 'none';

        }

        // When the user clicks the second button, open the second modal
        btn2.onclick = function() {
            modal2.style.display = "block";

            // to vanish the blue colored objects
            var navbarBrand = document.getElementsByClassName("navbar-brand");
            for (var i = 0; i < navbarBrand.length; i++) {
                navbarBrand[i].style.display = 'none';
            }

            var userInitials = document.getElementsByClassName("user-initials ml-3");
            for (var i = 0; i < userInitials.length; i++) {
                userInitials[i].style.display = 'none';
            }

            document.getElementById("save-continue").style.display = 'none';

        }

        // When the user clicks on <span> (x), close the first modal
        span1.onclick = function() {
            modal1.style.display = "none";

            // to appear the blue colored objects
            var navbarBrand = document.getElementsByClassName("navbar-brand");
            for (var i = 0; i < navbarBrand.length; i++) {
                navbarBrand[i].style.display = 'block';
            }

            var userInitials = document.getElementsByClassName("user-initials ml-3");
            for (var i = 0; i < userInitials.length; i++) {
                userInitials[i].style.display = 'flex';
            }

            document.getElementById("save-continue").style.display = 'block';
            
        }

        // When the user clicks on <span> (x), close the second modal
        span2.onclick = function() {
            modal2.style.display = "none";

            // to appear the blue colored objects
            var navbarBrand = document.getElementsByClassName("navbar-brand");
            for (var i = 0; i < navbarBrand.length; i++) {
                navbarBrand[i].style.display = 'block';
            }

            var userInitials = document.getElementsByClassName("user-initials ml-3");
            for (var i = 0; i < userInitials.length; i++) {
                userInitials[i].style.display = 'flex';
            }

            document.getElementById("save-continue").style.display = 'block';
        }

        // When the user clicks anywhere outside the modal, close the modal
        window.onclick = function(event) {
            if (event.target == modal1) {
                modal1.style.display = "none";

            // to appear the blue colored objects
            var navbarBrand = document.getElementsByClassName("navbar-brand");
            for (var i = 0; i < navbarBrand.length; i++) {
                navbarBrand[i].style.display = 'block';
            }

            var userInitials = document.getElementsByClassName("user-initials ml-3");
            for (var i = 0; i < userInitials.length; i++) {
                userInitials[i].style.display = 'flex';
            }

            document.getElementById("save-continue").style.display = 'block';
            } 
            
            else if (event.target == modal2) {
                modal2.style.display = "none";

            // to appear the blue colored objects
            var navbarBrand = document.getElementsByClassName("navbar-brand");
            for (var i = 0; i < navbarBrand.length; i++) {
                navbarBrand[i].style.display = 'block';
            }

            var userInitials = document.getElementsByClassName("user-initials ml-3");
            for (var i = 0; i < userInitials.length; i++) {
                userInitials[i].style.display = 'flex';
            }

            document.getElementById("save-continue").style.display = 'block';
            }
        }
    </script>

    

</body>
</html>

